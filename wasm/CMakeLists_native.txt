cmake_minimum_required(VERSION 3.10)
project(PokemonGame)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# Get the actual source directory by resolving the symlink
# This is needed because we use a symlinked CMakeLists.txt in build_native/
get_filename_component(WASM_DIR ${CMAKE_CURRENT_LIST_FILE} REALPATH)
get_filename_component(WASM_DIR ${WASM_DIR} DIRECTORY)

# Include directories
include_directories(${WASM_DIR}/include)

# Find SDL2
find_package(SDL2 REQUIRED)
if(NOT SDL2_FOUND)
    message(FATAL_ERROR "SDL2 not found! Please install SDL2.")
endif()

include_directories(${SDL2_INCLUDE_DIRS})

# Source files (exclude bindings.cpp - that's for WASM only)
set(SOURCES
    ${WASM_DIR}/src/town_map.cpp
    ${WASM_DIR}/src/player_character.cpp
    ${WASM_DIR}/src/encounter_system.cpp
    ${WASM_DIR}/src/modal_state.cpp
    ${WASM_DIR}/src/game.cpp
    ${WASM_DIR}/src/renderer.cpp
    ${WASM_DIR}/src/game_engine.cpp
    ${WASM_DIR}/src_native/main.cpp
)

# Note: src/bindings.cpp is NOT included - it's Emscripten-only

# Native executable
add_executable(pokemon-game-native ${SOURCES})

# Link SDL2
target_link_libraries(pokemon-game-native ${SDL2_LIBRARIES})

# Compiler flags
if(CMAKE_BUILD_TYPE MATCHES Debug)
    target_compile_options(pokemon-game-native PRIVATE -g -Wall -Wextra)
else()
    target_compile_options(pokemon-game-native PRIVATE -O3 -Wall)
endif()

